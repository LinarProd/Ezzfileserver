# EzzFileServer

EzzFileServer - это легковесный файловый сервер, написанный на языке Go. Он предоставляет простой и эффективный способ для хранения, управления и обмена файлами через веб-интерфейс.

## Содержание

1. [Обзор](#обзор)
2. [Функциональность](#функциональность)
3. [Архитектура](#архитектура)
4. [Установка](#установка)
5. [Конфигурация](#конфигурация)
6. [Использование](#использование)
7. [Безопасность](#безопасность)
8. [Разработка](#разработка)
9. [Лицензия](#лицензия)

## Обзор

EzzFileServer разработан как простое, но мощное решение для управления файлами. Он поддерживает различные режимы хранения данных (JSON и PostgreSQL), предоставляет веб-интерфейс для загрузки, скачивания и управления файлами, а также включает систему аутентификации пользователей с поддержкой ролей (администратор и обычный пользователь).

### Основные возможности

- Веб-интерфейс для управления файлами
- Система аутентификации пользователей
- Поддержка ролей (администратор и обычный пользователь)
- Загрузка, скачивание и удаление файлов
- Просмотр и редактирование текстовых файлов
- Поддержка различных режимов хранения данных
- Простой запуск и управление через скрипты

## Функциональность

### Управление пользователями

- Регистрация новых пользователей
- Аутентификация существующих пользователей
- Разделение прав доступа (администратор и обычный пользователь)
- Хранение учетных данных в JSON-файле или базе данных PostgreSQL

### Управление файлами

- Загрузка файлов на сервер
- Скачивание файлов с сервера
- Удаление файлов (только владельцем или администратором)
- Просмотр списка доступных файлов
- Просмотр и редактирование текстовых файлов
- Отображение информации о владельце файла и дате создания

### Веб-интерфейс

- Адаптивный дизайн с поддержкой светлой и темной темы
- Интуитивно понятный интерфейс для управления файлами
- Форма для входа и регистрации
- Список файлов с информацией о владельце
- Кнопки для скачивания, просмотра и удаления файлов

## Архитектура

EzzFileServer построен на основе следующих компонентов:

### Основные компоненты

1. **HTTP-сервер** - обрабатывает веб-запросы и маршрутизирует их к соответствующим обработчикам
2. **Система аутентификации** - управляет пользователями и их правами доступа
3. **Менеджер файлов** - отвечает за операции с файлами (загрузка, скачивание, удаление)
4. **Хранилище данных** - поддерживает два режима: JSON-файл и PostgreSQL
5. **Шаблонизатор** - генерирует HTML-страницы на основе шаблонов

### Структура проекта

```
ezzfileserver/
├── build/                  # Директория для сборки
│   ├── run.bat             # Скрипт запуска для Windows
│   ├── run.sh              # Скрипт запуска для Linux
│   ├── config.json         # Конфигурационный файл
│   ├── users.json          # Файл с пользователями (для JSON-режима)
│   ├── files/              # Директория для хранения файлов
│   ├── templates/          # HTML-шаблоны
│   └── static/             # Статические файлы (CSS, JS)
├── main.go                 # Основной файл приложения
├── config.json             # Конфигурационный файл
├── users.json              # Файл с пользователями (для JSON-режима)
├── go.mod                  # Файл зависимостей Go
├── go.sum                  # Файл контрольных сумм зависимостей
└── LICENSE                 # Лицензия проекта
```

## Установка

### Предварительные требования

- Go 1.16 или выше
- PostgreSQL (опционально, если используется режим PostgreSQL)

### Установка из исходного кода

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/yourusername/ezzfileserver.git
   cd ezzfileserver
   ```

2. Соберите приложение:
   ```
   go build -o ezzfileserver
   ```

3. Скопируйте необходимые файлы в директорию для запуска:
   ```
   mkdir -p build
   cp ezzfileserver build/
   cp config.json build/
   cp users.json build/
   cp -r templates build/
   cp -r static build/
   mkdir -p build/files
   ```

## Конфигурация

Конфигурация сервера осуществляется через файл `config.json`:

```json
{
    "server_host": "0.0.0.0",
    "server_port": "8080",
    "file_dir": "./files",
    "user_file": "./users.json",
    "storage_mode": "json",
    "db_host": "localhost",
    "db_port": "5432",
    "db_user": "postgres",
    "db_password": "123",
    "db_name": "postgredb"
}
```

### Параметры конфигурации

- **server_host** - адрес, на котором будет запущен сервер (0.0.0.0 для всех интерфейсов)
- **server_port** - порт, на котором будет запущен сервер
- **file_dir** - директория для хранения загруженных файлов
- **user_file** - путь к файлу с пользователями (для JSON-режима)
- **storage_mode** - режим хранения данных ("json" или "postgresql")
- **db_host** - адрес сервера PostgreSQL
- **db_port** - порт сервера PostgreSQL
- **db_user** - имя пользователя PostgreSQL
- **db_password** - пароль пользователя PostgreSQL
- **db_name** - имя базы данных PostgreSQL

## Использование

### Запуск сервера

#### Windows

```
cd build
run.bat
```

#### Linux

```
cd build
chmod +x run.sh
./run.sh
```

### Управление сервером

После запуска сервер доступен по адресу `http://localhost:8080` (или другому адресу, указанному в конфигурации).

#### Команды для управления сервером

- **restart** - перезапуск сервера
- **exit** - остановка сервера и выход

### Работа с веб-интерфейсом

1. **Регистрация** - создайте новую учетную запись, указав имя пользователя и пароль
2. **Вход** - авторизуйтесь, используя существующую учетную запись
3. **Загрузка файлов** - используйте форму для загрузки файлов на сервер
4. **Управление файлами** - просматривайте, скачивайте и удаляйте файлы через веб-интерфейс
5. **Редактирование файлов** - просматривайте и редактируйте текстовые файлы
6. **Выход** - завершите сессию, нажав кнопку "Выйти"

## Безопасность

### Аутентификация и авторизация

- Все операции с файлами требуют аутентификации
- Только владелец файла или администратор может удалять файлы
- Пароли хранятся в открытом виде (в будущих версиях планируется добавление хеширования)

### Ограничения

- Сервер не имеет встроенной защиты от DDoS-атак
- Отсутствует шифрование данных при передаче (рекомендуется использовать HTTPS)
- Нет защиты от инъекций SQL (при использовании режима PostgreSQL)

## Разработка

### Добавление новых функций

#### Добавление нового обработчика HTTP-запросов

1. Создайте новую функцию-обработчик в файле `main.go`:
   ```go
   func newHandler(w http.ResponseWriter, r *http.Request) {
       // Логика обработки запроса
   }
   ```

2. Зарегистрируйте обработчик в функции `main()`:
   ```go
   http.HandleFunc("/new-path", newHandler)
   ```

#### Добавление нового шаблона

1. Создайте новый HTML-файл в директории `templates/`
2. Добавьте шаблон в список шаблонов в функции `main()`:
   ```go
   templates = template.Must(template.New("main.html").Funcs(template.FuncMap{
       "lower": strings.ToLower,
   }).ParseFiles("templates/main.html", "templates/game.html", "templates/new.html"))
   ```

### Сборка для разных платформ

#### Windows

```
GOOS=windows GOARCH=amd64 go build -o ezzfileserver.exe
```

#### Linux

```
GOOS=linux GOARCH=amd64 go build -o ezzfileserver
```

#### macOS

```
GOOS=darwin GOARCH=amd64 go build -o ezzfileserver
```

## Лицензия

EzzFileServer распространяется под лицензией GNU General Public License v3.0. Подробности можно найти в файле `LICENSE`.

---

EzzFileServer - простое и эффективное решение для управления файлами. Он предоставляет все необходимые функции для загрузки, скачивания и управления файлами через веб-интерфейс, а также систему аутентификации пользователей с поддержкой ролей.
